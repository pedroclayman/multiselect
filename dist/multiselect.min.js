angular.module("multi-select",[]),angular.module("multi-select").directive("multiSelectChoices",["constants",function(e){function t(e){}return{restrict:"E",require:["^multiSelect","multiSelectChoices"],templateUrl:"multiSelect/choices",scope:!0,link:function(t,n,i,l){function c(){t.currentIndex=t.filteredChoices.length>0?0:-1}function o(e){t.selectItem(e),c(),t.options.closeOnSelect&&(t.options.isOpen=!1)}var s=l[0],r=l[1];s.registerCtrl("choices",r),t.currentIndex=0,t.filteredChoices=[],r.handleEvent=function(n){switch(n.keyCode){case e.KEY.DOWN:t.options.isOpen?t.currentIndex=(t.currentIndex+1)%t.filteredChoices.length:(t.options.isOpen=!0,t.currentIndex=0);break;case e.KEY.UP:t.currentIndex=t.currentIndex-1<0?t.filteredChoices.length-1:t.currentIndex-1;break;case e.KEY.ENTER:t.options.isOpen&&o(t.filteredChoices[t.currentIndex])}},t.$watch("options.searchTerm",function(){c()}),t.choiceClicked=function(e){o(e)},t.$on("$destroy",function(){s.unregisterCtrl("choices")})},controller:["$scope",t]}}]),angular.module("multi-select").filter("unselected",[function(){return function(e,t){return e.filter(function(e){return t.indexOf(e)===-1})}}]),angular.module("multi-select").constant("constants",{KEY:{LEFT:37,RIGHT:39,UP:38,DOWN:40,TAB:9,BACKSPACE:8,DELETE:46,ENTER:13}}),angular.module("multi-select").directive("multiSelect",["constants",function(e){function t(){}var n=[];return{restrict:"E",templateUrl:"multiSelect/main",require:["ngModel","multiSelect"],scope:{choices:"="},controller:["$scope",t],compile:function(){return{pre:function(e,t,i,l){var c=l[0],o=l[1];o.open=function(){e.options.isOpen=!0},o.close=function(){e.options.isOpen=!1},o.registerCtrl=function(e,t){n[e]=t},o.unregisterCtrl=function(e){var t=n.indexOf(e);t!==-1&&n.splice(t,-1)},o.getItems=e.getItems=function(){return c.$modelValue},o.selectItem=e.selectItem=function(e){c.$modelValue.push(e)},o.unselectItem=e.unselectItem=function(e){var t=c.$modelValue,n=t.indexOf(e);n>-1&&t.splice(n,1)}},post:function(t,i,l,c){function o(i){~[e.KEY.LEFT,e.KEY.RIGHT,e.KEY.BACKSPACE,e.KEY.DELETE].indexOf(i.keyCode)?n.pills.handleEvent(i):~[e.KEY.UP,e.KEY.DOWN,e.KEY.ENTER].indexOf(i.keyCode)&&n.choices.handleEvent(i),t.$apply()}function s(e){t.options.isOpen||t.$apply(function(){t.options.isOpen=!0})}function r(e){t.options.isOpen||t.$apply(function(){t.options.isOpen=!0})}function u(e){t.options.isOpen&&t.$apply(function(){t.options.isOpen=!1})}function p(){l.$observe("closeOnSelect",function(e){t.options.closeOnSelect=null==e||t.$eval(e)})}c[0],c[1];t.options={},p(l),i[0].addEventListener("keydown",o);var a=i[0].querySelector("input[type=search]");a.addEventListener("click",s),a.addEventListener("focusin",r),a.addEventListener("focusout",u),t.$on("$destroy",function(){i[0].removeEventListener("keydown",o),a.removeEventListener("click",s),a.removeEventListener("focusin",r),a.removeEventListener("focusout",u)})}}}}}]),angular.module("multi-select").run(["$templateCache",function(e){e.put("multiSelect/main",'<multi-select-pills></multi-select-pills><input type="search" ng-model="options.search" /><multi-select-choices></multi-select-choices>'),e.put("multiSelect/pills",'<ul class="pills" ng-show="getItems().length"><li ng-repeat="item in getItems()">{{item}}&nbsp;<a tabindex="-1" href ng-click="unselectItem(item)">x</a></li></ul>'),e.put("multiSelect/choices",'<ul class="choices" ng-show="options.isOpen"><li ng-repeat="item in choices | filter : options.search | unselected : getItems() as filteredChoices" ng-class="{\'selected\' : $index === currentIndex }"><a href tabindex="-1" ng-click="choiceClicked(item)">{{item}}</a></li></ul>')}]),angular.module("multi-select").directive("multiSelectPills",[function(){function e(){}return{restrict:"E",require:["^multiSelect","multiSelectPills"],templateUrl:"multiSelect/pills",link:function(e,t,n,i){var l=i[0],c=i[1];l.registerCtrl("pills",c),c.handleEvent=function(e){console.log("pills")},e.$on("$destroy",function(){l.unregisterCtrl("pills")})},controller:[e]}}]);