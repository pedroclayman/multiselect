!function(){function e(e){var t="focus"===e.type?"focusin":"focusout",n=new CustomEvent(t,{bubbles:!0,cancelable:!1});n.c1Generated=!0,e.target.dispatchEvent(n)}function t(n){n.c1Generated||(o.removeEventListener("focus",e,!0),o.removeEventListener("blur",e,!0),o.removeEventListener("focusin",t,!0),o.removeEventListener("focusout",t,!0)),setTimeout(function(){o.removeEventListener("focusin",t,!0),o.removeEventListener("focusout",t,!0)})}var n=window,o=n.document;void 0===n.onfocusin&&(o.addEventListener("focus",e,!0),o.addEventListener("blur",e,!0),o.addEventListener("focusin",t,!0),o.addEventListener("focusout",t,!0))}(),angular.module("multi-select",[]),Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,n=window.getComputedStyle(t,null),o=parseInt(n.getPropertyValue("border-top-width")),i=parseInt(n.getPropertyValue("border-left-width")),l=this.offsetTop-t.offsetTop<t.scrollTop,c=this.offsetTop-t.offsetTop+this.clientHeight-o>t.scrollTop+t.clientHeight,r=this.offsetLeft-t.offsetLeft<t.scrollLeft,s=this.offsetLeft-t.offsetLeft+this.clientWidth-i>t.scrollLeft+t.clientWidth,u=l&&!c;(l||c)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-o+this.clientHeight/2),(r||s)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-i+this.clientWidth/2),(l||c||r||s)&&!e&&this.scrollIntoView(u)}),angular.module("multi-select").directive("multiSelectChoices",["constants","$timeout",function(e,t){function n(e){}return{restrict:"E",require:["^multiSelect","multiSelectChoices","scrollTo"],templateUrl:"multiSelect/choices",scope:!0,link:function(n,o,i,l){function c(){n.currentIndex=n.filteredChoices.length>0?0:-1}function r(e){n.selectItem(e),c(),n.options.closeOnSelect&&(n.options.isOpen=!1),n.options.resetInput&&n.$apply(function(){n.resetInput(),console.log("reset")})}var s=l[0],u=l[1],f=l[2];s.registerCtrl("choices",u),n.currentIndex=0,n.filteredChoices=[],u.handleEvent=function(o){switch(o.keyCode){case e.KEY.DOWN:n.options.isOpen?(n.currentIndex=(n.currentIndex+1)%n.filteredChoices.length,t(function(){f.scrollTo(".selected")})):(n.options.isOpen=!0,n.currentIndex=0);break;case e.KEY.UP:n.currentIndex=n.currentIndex-1<0?n.filteredChoices.length-1:n.currentIndex-1,t(function(){f.scrollTo(".selected")});break;case e.KEY.ENTER:n.options.isOpen&&r(n.filteredChoices[n.currentIndex])}},n.$watch("options.searchTerm",function(){c()}),n.choiceClicked=function(e,t){r(e)},n.$on("$destroy",function(){s.unregisterCtrl("choices")})},controller:["$scope",n]}}]),angular.module("multi-select").filter("unselected",[function(){return function(e,t){return t?e.filter(function(e){return t.indexOf(e)===-1}):e}}]),angular.module("multi-select").constant("constants",{KEY:{LEFT:37,RIGHT:39,UP:38,DOWN:40,TAB:9,BACKSPACE:8,DELETE:46,ENTER:13}}),angular.module("multi-select").directive("multiSelect",["constants","$parse",function(e,t){function n(){return Event.prototype.hasOwnProperty("path")}function o(){}return{restrict:"E",templateUrl:"multiSelect/main",require:["ngModel","multiSelect"],scope:{choices:"=",placeholder:"@",model:"=ngModel"},controller:["$scope",o],compile:function(){var t=[];return{pre:function(e,n,o,i){var l=i[0],c=i[1];c.open=function(){e.options.isOpen=!0},c.close=function(){e.options.isOpen=!1},c.registerCtrl=function(e,n){t[e]=n},c.unregisterCtrl=function(e){var n=t.indexOf(e);n!==-1&&t.splice(n,-1)},c.getItems=e.getItems=function(){return l.$modelValue},c.selectItem=e.selectItem=function(t){null==l.$modelValue?e.model=[t]:e.model.push(t)},c.unselectItem=e.unselectItem=function(e){if(null!=l.$modelValue){var t=l.$modelValue,n=t.indexOf(e);n>-1&&t.splice(n,1)}},c.resetInput=e.resetInput=function(){e.options.search=null}},post:function(o,i,l,c){function r(n){~[e.KEY.LEFT,e.KEY.RIGHT,e.KEY.BACKSPACE,e.KEY.DELETE].indexOf(n.keyCode)?t.pills.handleEvent(n):~[e.KEY.UP,e.KEY.DOWN,e.KEY.ENTER].indexOf(n.keyCode)&&t.choices.handleEvent(n),o.$apply()}function s(e){n()||(null==e.path&&(e.path=[]),e.path.push(i[0].querySelector("input")))}function u(e){function t(){if(e.path){var t=i[0].querySelector("input"),n=e.path.filter(function(e){return e===t});return n.length>0}return!1}console.log("element",e.path),n()||(null==e.path&&(e.path=[]),e.path.push(i[0])),!o.options.isOpen&&t()&&o.$apply(function(){o.options.isOpen=!0})}function f(e){function t(){if(e.path){var t=e.path.filter(function(e){return e===i[0]});return t.length>0}return!1}console.log("body",e.path),o.options.isOpen===!1||t()||o.$apply(function(){o.options.isOpen=!1})}function p(){o.options.closeOnSelect=!0,o.options.resetInput=!0,l.$observe("closeOnSelect",function(e){o.options.closeOnSelect=null==e||o.$eval(e)}),l.$observe("resetInput",function(e){o.options.resetInput=null==e||o.$eval(e)})}console.dir(Event),console.log(Object.prototype.hasOwnProperty(Event,"path"));c[0],c[1];o.options={},p(l),i[0].addEventListener("keydown",r);var a=i[0].querySelector("input[type=search]");a.addEventListener("click",s),a.addEventListener("focusin",s),i[0].addEventListener("click",u),i[0].addEventListener("focusin",u);var d=document.querySelector("body");d.addEventListener("focusin",f),d.addEventListener("click",f),o.$on("$destroy",function(){a.removeEventListener("click",s),a.removeEventListener("focusin",s),i[0].removeEventListener("keydown",r),i[0].removeEventListener("focusin",u),i[0].removeEventListener("click",u),d.removeEventListener("focusin",f),d.removeEventListener("click",f)})}}}}}]),angular.module("multi-select").run(["$templateCache",function(e){e.put("multiSelect/main",'<multi-select-pills></multi-select-pills><input type="search" ng-model="options.search" placeholder="{{placeholder}}" /><multi-select-choices tabindex="-1" scroll-to></multi-select-choices>'),e.put("multiSelect/pills",'<ul class="pills" ng-show="getItems().length"><li ng-repeat="item in getItems()">{{item}}&nbsp;<a tabindex="-1" href ng-click="unselectItem(item)">x</a></li></ul>'),e.put("multiSelect/choices",'<ul class="choices" ng-show="options.isOpen" tabindex="-1"><li ng-repeat="item in choices | filter : options.search | unselected : getItems() as filteredChoices" ng-class="{\'selected\' : $index === currentIndex }"><a tabindex="-1" ng-click="choiceClicked(item, $event)">{{item}}</a></li></ul>')}]),angular.module("multi-select").directive("multiSelectPills",[function(){function e(){}return{restrict:"E",require:["^multiSelect","multiSelectPills"],templateUrl:"multiSelect/pills",link:function(e,t,n,o){var i=o[0],l=o[1];i.registerCtrl("pills",l),l.handleEvent=function(e){console.log("pills")},e.$on("$destroy",function(){i.unregisterCtrl("pills")})},controller:[e]}}]),angular.module("multi-select").directive("scrollTo",[function(){function e(){}return{restrict:"A",scope:!1,require:["scrollTo"],controller:[e],link:function(e,t,n,o){var i=o[0];i.scrollTo=function(e){var n=t[0].querySelector(e);n.scrollIntoViewIfNeeded()}}}}]);