!function(){function e(e){var t="focus"===e.type?"focusin":"focusout",n=new CustomEvent(t,{bubbles:!0,cancelable:!1});n.c1Generated=!0,e.target.dispatchEvent(n)}function t(n){n.c1Generated||(i.removeEventListener("focus",e,!0),i.removeEventListener("blur",e,!0),i.removeEventListener("focusin",t,!0),i.removeEventListener("focusout",t,!0)),setTimeout(function(){i.removeEventListener("focusin",t,!0),i.removeEventListener("focusout",t,!0)})}var n=window,i=n.document;void 0===n.onfocusin&&(i.addEventListener("focus",e,!0),i.addEventListener("blur",e,!0),i.addEventListener("focusin",t,!0),i.addEventListener("focusout",t,!0))}(),angular.module("multi-select",[]),Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,n=window.getComputedStyle(t,null),i=parseInt(n.getPropertyValue("border-top-width")),o=parseInt(n.getPropertyValue("border-left-width")),l=this.offsetTop-t.offsetTop<t.scrollTop,s=this.offsetTop-t.offsetTop+this.clientHeight-i>t.scrollTop+t.clientHeight,r=this.offsetLeft-t.offsetLeft<t.scrollLeft,c=this.offsetLeft-t.offsetLeft+this.clientWidth-o>t.scrollLeft+t.clientWidth,u=l&&!s;(l||s)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-i+this.clientHeight/2),(r||c)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-o+this.clientWidth/2),(l||s||r||c)&&!e&&this.scrollIntoView(u)}),angular.module("multi-select").directive("multiSelectChoices",["constants","$timeout",function(e,t){function n(){return Event.prototype.hasOwnProperty("path")}function i(e){}return{restrict:"E",require:["^multiSelect","multiSelectChoices"],templateUrl:"multiSelect/choices",scope:!0,link:function(i,o,l,s){function r(){i.currentIndex=i.filteredChoices&&i.filteredChoices.length>0?0:-1}function c(e){i.selectItem(e),r(),i.options.closeOnSelect&&(i.options.isOpen=!1),i.options.resetInput&&i.resetInput()}function u(e){var t=h.querySelector(e);t&&t.scrollIntoViewIfNeeded()}function d(){h.style.width=m.clientWidth+"px";var e=m.getBoundingClientRect(),t=(parseFloat(window.getComputedStyle(m).paddingBottom)||0)+(parseFloat(window.getComputedStyle(m).borderBottom)||0),n=(parseFloat(window.getComputedStyle(m).paddingLeft)||0)+(parseFloat(window.getComputedStyle(m).borderLeft)||0);h.style.left=e.left+n+"px",h.style.top=e.bottom+t+"px"}function a(e){n()||(null==e.path&&(e.path=[]),e.path.push(h)),v.focus()}var f=s[0],p=s[1];f.registerCtrl("choices",p);var h=o[0].querySelector(".multi-select-choices"),m=o[0].parentElement,v=m.querySelector("input[type=search]"),E=document.querySelector("body");i.currentIndex=0,i.filteredChoices=[],p.handleEvent=function(n){switch(n.keyCode){case e.KEY.DOWN:i.options.isOpen?(i.currentIndex=(i.currentIndex+1)%i.filteredChoices.length,t(function(){u(".selected")})):(i.options.isOpen=!0,i.currentIndex=0);break;case e.KEY.UP:i.currentIndex=i.currentIndex-1<0?i.filteredChoices.length-1:i.currentIndex-1,t(function(){u(".selected")});break;case e.KEY.ENTER:i.options.isOpen&&c(i.filteredChoices[i.currentIndex]);break;case e.KEY.ESC:i.options.isOpen=!1}},i.$watch("options.search",function(e,t){e!==t&&(r(),e&&e.length&&(i.options.isOpen=!0))});var y;i.$watch("options.isOpen",function(e,n){e!==n&&(e?(d(),E.appendChild(h),h.addEventListener("focusin",a),y=i.$watch("model",function(){console.log("model has changed"),t(function(){d()})})):(null!=y&&(y(),y=null),h.removeEventListener("focusin",a),o[0].appendChild(h)))}),i.choiceClicked=function(e,t){c(e)},i.$on("$destroy",function(){h.removeEventListener("focusin",a),f.unregisterCtrl("choices")})},controller:["$scope",i]}}]),angular.module("multi-select").filter("unselected",[function(){return function(e,t,n){return null==t?e:e.filter(function(e){return t.indexOf(n(e))===-1})}}]),angular.module("multi-select").factory("choicesResolver",[function(){function e(e,t){}function t(){}return{getKey:e,getValue:t}}]),angular.module("multi-select").constant("constants",{KEY:{LEFT:37,RIGHT:39,UP:38,DOWN:40,TAB:9,BACKSPACE:8,DELETE:46,ENTER:13,ESC:27}}),angular.module("multi-select").directive("multiSelect",["constants","$parse",function(e,t){function n(){return Event.prototype.hasOwnProperty("path")}function i(){}return{restrict:"E",templateUrl:"multiSelect/main",require:["ngModel","multiSelect"],scope:{choices:"=",placeholder:"@",model:"=ngModel"},controller:["$scope",i],compile:function(i,o){var l=[];return{pre:function(e,t,n,i){var o=i[0],s=i[1];s.open=function(){e.options.isOpen=!0},s.close=function(){e.options.isOpen=!1},s.registerCtrl=function(e,t){l[e]=t},s.unregisterCtrl=function(e){var t=l.indexOf(e);t!==-1&&l.splice(t,-1)},s.selectItem=e.selectItem=function(t){var n=e.resolveValueByItem(t);null==o.$modelValue?e.model=[n]:e.model.push(n)},s.unselectItem=e.unselectItem=function(e){if(null!=o.$modelValue){var t=o.$modelValue,n=t.indexOf(e);n>-1&&t.splice(n,1)}},s.resetInput=e.resetInput=function(){e.options.search=""}},post:function(i,o,s,r){function c(t){~[e.KEY.LEFT].indexOf(t.keyCode)?0==h.selectionStart&&l.pills.handleEvent(t):~[e.KEY.RIGHT].indexOf(t.keyCode)?0==h.selectionStart&&i.options.selectedPillIndex!==-1&&l.pills.handleEvent(t):~[e.KEY.BACKSPACE,e.KEY.DELETE].indexOf(t.keyCode)?l.pills.handleEvent(t):~[e.KEY.UP,e.KEY.DOWN,e.KEY.ENTER,e.KEY.ESC].indexOf(t.keyCode)&&l.choices.handleEvent(t),i.$apply()}function u(t){~[e.KEY.LEFT,e.KEY.RIGHT].indexOf(t.keyCode)&&0==h.selectionStart&&i.options.selectedPillIndex!==-1&&t.preventDefault(),~[e.KEY.TAB].indexOf(t.keyCode)&&i.$apply(function(){i.options.selectedPillIndex=-1})}function d(e){n()||(null==e.path&&(e.path=[]),e.path.push(h))}function a(e){function t(){if(e.path){var t=e.path.filter(function(e){return e===h});return t.length>0}return!1}n()||(null==e.path&&(e.path=[]),e.path.push(o[0])),!i.options.isOpen&&t()&&i.$apply(function(){i.options.isOpen=!0})}function f(e){function t(){if(e.path){var t=e.path.filter(function(e){return e===o[0]||e.classList&&e.classList.contains("multi-select-choices")});return t.length>0}return!1}i.options.isOpen===!1||t()||i.$apply(function(){i.options.isOpen=!1})}function p(){i.options.closeOnSelect=!0,i.options.resetInput=!0,s.$observe("closeOnSelect",function(e){i.options.closeOnSelect=null==e||i.$eval(e)}),s.$observe("resetInput",function(e){i.options.resetInput=null==e||i.$eval(e)})}var h=(r[0],r[1],o[0].querySelector("input[type=search]"));i.resolveAbbrevationByItem=function(e){if(s.abbrevationKey){var n=t(s.abbrevationKey),o=n(e);if(o)return o}return i.resolveLabelByItem(e)},i.resolveLabelByItem=function(e){if(s.labelKey){var n=t(s.labelKey),i=n(e);if(i)return i}return e},i.resolveValueByItem=function(e){if(s.labelValue){var n=t(s.labelValue);return n(e)}return e},i.resolveItemsFromCollectionByValue=function(e,n){var i;return i=s.labelValue?t(s.labelValue):function(e){return e},e.filter(function(e){return i(e)===n})},i.resolveChoiceByValue=function(e){var t=i.resolveItemsFromCollectionByValue(i.choices,e);return null!=t||t.length>0?t[0]:null},i.options={selectedPillIndex:-1,search:""},p(s),o[0].addEventListener("keydown",c),h.addEventListener("click",d),h.addEventListener("focusin",d),h.addEventListener("keydown",u),o[0].addEventListener("click",a),o[0].addEventListener("focusin",a),document.addEventListener("focusin",f),document.addEventListener("click",f),i.$on("$destroy",function(){h.removeEventListener("click",d),h.removeEventListener("focusin",d),h.removeEventListener("keydown",u),o[0].removeEventListener("keydown",c),o[0].removeEventListener("focusin",a),o[0].removeEventListener("click",a),document.removeEventListener("focusin",f),document.removeEventListener("click",f)})}}}}}]),angular.module("multi-select").directive("multiSelect",["resizeSensor","$window",function(e,t){return{link:function(n,i,o,l){function s(){var e=i[0].querySelectorAll(".pills li");if(e.length>0){var n=e[e.length-1],o=i[0].querySelector(".pills").getBoundingClientRect(),l=n.getBoundingClientRect(),s=parseFloat(t.getComputedStyle(i[0]).width),u=l.right-o.left;s-u>r?c.style.width=s-u+"px":c.style.width="100%"}else c.style.width="100%"}var r=50,c=i[0].querySelector("input[type=search]");e(i[0],s),n.$on("$destroy",function(){e.detach(i[0],s)})}}}]),angular.module("multi-select").run(["$templateCache",function(e){e.put("multiSelect/main",'<multi-select-pills></multi-select-pills><input type="search" ng-model="options.search" placeholder="{{placeholder}}" /><multi-select-choices tabindex="-1" scroll-to></multi-select-choices>'),e.put("multiSelect/pills",'<ul class="pills" ng-show="model != null && model.length"><li ng-class="{\'selected\' : $index === options.selectedPillIndex }" ng-repeat="item in model">{{resolveAbbrevationByItem(resolveChoiceByValue(item))}}&nbsp;<a tabindex="-1" href ng-click="unselectItem(item)">x</a></li></ul>'),e.put("multiSelect/choices",'<ul class="multi-select-choices" ng-show="options.isOpen" tabindex="-1"><li ng-repeat="item in choices | filter : options.search | unselected : model : resolveValueByItem as filteredChoices" ng-class="{\'selected\' : $index === currentIndex }"><a tabindex="-1" ng-click="choiceClicked(item, $event)">{{resolveLabelByItem(item)}}</a></li></ul>')}]),angular.module("multi-select").directive("multiSelectPills",["constants",function(e){function t(){}return{restrict:"E",require:["^multiSelect","multiSelectPills"],templateUrl:"multiSelect/pills",link:function(t,n,i,o){var l=o[0],s=o[1];l.registerCtrl("pills",s),s.handleEvent=function(n){var i=t.model?t.model.length:0;switch(n.keyCode){case e.KEY.LEFT:t.options.selectedPillIndex===-1?t.options.selectedPillIndex=i-1:t.options.selectedPillIndex>0&&t.options.selectedPillIndex--;break;case e.KEY.RIGHT:t.options.selectedPillIndex<i-1?t.options.selectedPillIndex++:t.options.selectedPillIndex===i-1&&(t.options.selectedPillIndex=-1);break;case e.KEY.BACKSPACE:t.options.selectedPillIndex>-1&&(t.model.splice(t.options.selectedPillIndex,1),0===i?t.options.selectedPillIndex=-1:t.options.selectedPillIndex>0&&t.options.selectedPillIndex--);break;case e.KEY.DELETE:t.options.selectedPillIndex>-1&&(t.model.splice(t.options.selectedPillIndex,1),0===i?t.options.selectedPillIndex=-1:t.options.selectedPillIndex>i-1&&t.options.selectedPillIndex--)}},t.$on("$destroy",function(){l.unregisterCtrl("pills")})},controller:[t]}}]),angular.module("multi-select").factory("resizeSensor",[function(){function e(e,t){var n=Object.prototype.toString.call(e),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,o=0,l=e.length;if(i)for(;o<l;o++)t(e[o]);else t(e)}var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,n=function(i,o){function l(){var e=[];this.add=function(t){e.push(t)};var t,n;this.call=function(){for(t=0,n=e.length;t<n;t++)e[t].call()},this.remove=function(i){var o=[];for(t=0,n=e.length;t<n;t++)e[t]!==i&&o.push(e[t]);e=o},this.length=function(){return e.length}}function s(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):e.style[t]}function r(e,n){if(e.resizedAttached){if(e.resizedAttached)return void e.resizedAttached.add(n)}else e.resizedAttached=new l,e.resizedAttached.add(n);e.resizeSensor=document.createElement("div"),e.resizeSensor.className="resize-sensor";var i="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",o="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeSensor.style.cssText=i,e.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+i+'"><div style="'+o+'"></div></div><div class="resize-sensor-shrink" style="'+i+'"><div style="'+o+' width: 200%; height: 200%"></div></div>',e.appendChild(e.resizeSensor),"static"==s(e,"position")&&(e.style.position="relative");var r=e.resizeSensor.childNodes[0],c=r.childNodes[0],u=e.resizeSensor.childNodes[1],d=function(){c.style.width=1e5+"px",c.style.height=1e5+"px",r.scrollLeft=1e5,r.scrollTop=1e5,u.scrollLeft=1e5,u.scrollTop=1e5};d();var a=!1,f=function(){e.resizedAttached&&(a&&(e.resizedAttached.call(),a=!1),t(f))};t(f);var p,h,m,v,E=function(){(m=e.offsetWidth)==p&&(v=e.offsetHeight)==h||(a=!0,p=m,h=v),d()},y=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};y(r,"scroll",E),y(u,"scroll",E)}e(i,function(e){r(e,o)}),this.detach=function(e){n.detach(i,e)}};return n.detach=function(t,n){e(t,function(e){e.resizedAttached&&"function"==typeof n&&(e.resizedAttached.remove(n),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached)})},n}]);